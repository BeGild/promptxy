{
  // promptxy 配置文件示例
  // 复制此文件为 promptxy.config.json 并根据需要修改

  // 监听配置
  "listen": {
    "host": "127.0.0.1", // 绑定主机（建议保持 localhost 以保证安全）
    "port": 7070 // 监听端口
  },

  // 上游 API 地址
  "upstreams": {
    "anthropic": "https://api.anthropic.com", // Claude Code 上游
    "openai": "https://api.openai.com", // Codex CLI 上游
    "gemini": "https://generativelanguage.googleapis.com" // Gemini CLI 上游
  },

  // 规则数组 - 按顺序执行
  "rules": [
    // 示例 1：强制所有 CLI 使用中文
    {
      "id": "force-chinese-claude",
      "when": { "client": "claude", "field": "system" },
      "ops": [{ "type": "append", "text": "\nAlways respond in Chinese." }]
    },
    {
      "id": "force-chinese-codex",
      "when": { "client": "codex", "field": "instructions" },
      "ops": [{ "type": "append", "text": "\nAlways respond in Chinese." }]
    },
    {
      "id": "force-chinese-gemini",
      "when": { "client": "gemini", "field": "system" },
      "ops": [{ "type": "append", "text": "\nAlways respond in Chinese." }]
    },

    // 示例 2：删除 Claude 的文件大小限制
    {
      "id": "remove-file-limit",
      "when": { "client": "claude", "field": "system" },
      "ops": [{ "type": "delete", "regex": "file size.*?\\d+MB", "flags": "i" }]
    },

    // 示例 3：在 Codex 指令中插入自定义规则
    {
      "id": "codex-insert-helpful",
      "when": { "client": "codex", "field": "instructions" },
      "ops": [
        { "type": "insert_after", "regex": "^You are", "text": " Always be helpful and detailed." }
      ]
    },

    // 示例 4：替换特定关键词
    {
      "id": "replace-concise",
      "when": { "client": "claude", "field": "system" },
      "ops": [
        { "type": "replace", "match": "be concise", "replacement": "be thorough and detailed" }
      ]
    },

    // 示例 5：仅对特定模型生效
    {
      "id": "sonnet-specific",
      "when": {
        "client": "claude",
        "field": "system",
        "modelRegex": "sonnet"
      },
      "ops": [{ "type": "append", "text": "\nOptimize for code quality." }]
    },

    // 示例 6：多操作组合
    {
      "id": "comprehensive-codex",
      "when": { "client": "codex", "field": "instructions" },
      "ops": [
        { "type": "prepend", "text": "CUSTOM RULES:\n" },
        { "type": "delete", "regex": "be brief", "flags": "i" },
        { "type": "append", "text": "\nProvide examples when possible." }
      ]
    }
  ],

  // 调试模式（打印规则匹配详情，不打印敏感信息）
  "debug": false
}
