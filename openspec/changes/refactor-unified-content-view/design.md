## Context

当前详情页面 UI 设计采用三个独立视图通过标签切换的架构，用户反馈界面层级过多，默认展示的"结构概览"不是最常用的功能。需要简化界面层级，提升默认体验。

## Goals / Non-Goals

**Goals:**
- 简化界面层级，移除视图切换标签区域
- 默认直接进入内容详情视图
- 差异对比功能作为工具栏按钮，一键切换
- 代码结构更简洁，减少组件数量

**Non-Goals:**
- 不改变现有的差异计算逻辑
- 不影响现有的元数据栏显示
- 不影响请求适配器接口

## Decisions

### Decision 1: 扩展 FileBrowserView 而非创建新组件

**选择**：将 `FileBrowserView` 扩展为 `UnifiedContentView`，在其中添加差异对比模式切换。

**理由**：
- `FileBrowserView` 已具备完整的文件树导航、内容面板、工具栏功能
- 差异对比本质上是内容面板的另一种展示模式
- 避免重复代码，保持代码简洁

**替代方案**：创建全新的 `UnifiedContentView` 组件
- 缺点：需要复制大量现有代码，增加维护成本

### Decision 2: 工具栏按钮状态矩阵

不同模式下工具栏按钮的显示/隐藏逻辑：

| 按钮 | 内容详情模式 | 差异对比模式 |
|------|-------------|-------------|
| 差异对比 | ○ 显示（未激活） | ● 显示（已激活） |
| 纯文本 | ○ 显示 | ○ 显示（并列） |
| 预览 | ○ 显示 | ○ 显示（并列） |
| ← 上一个 | - 隐藏 | ○ 显示（有差异时） |
| 下一个 → | - 隐藏 | ○ 显示（有差异时） |
| 复制 | ○ 显示 | ○ 显示 |
| 创建规则 | ○ 显示 | ○ 显示 |
| 全屏 | ○ 显示 | ○ 显示 |

**说明**：纯文本/预览切换在两种模式下都可用，差异对比模式下不影响差异高亮显示。

### Decision 3: 组件复用策略

- 保留 `DiffContentPanel`：在差异对比模式下复用
- 保留 `FileTree`：两种模式共享
- 保留 `FileContentPanel`：内容详情模式使用
- 删除 `DiffToolbar`：导航按钮整合到统一工具栏

## Architecture

```
┌─────────────────────────────────────────────────────────────┐
│                      RequestDetailPanel                      │
│  - 简化：移除 viewMode state 和视图切换标签                   │
│  - 直接渲染 UnifiedContentView                               │
└─────────────────────────────────────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────────────┐
│                   UnifiedContentView                        │
│  State:                                                      │
│    - isDiffMode: boolean                                    │
│    - selectedNode, isFullScreen, ... (现有状态)             │
│                                                              │
│  工具栏:                                                      │
│    - 差异对比按钮 (条件渲染: originalTree 存在)              │
│    - 纯文本/预览 (两种模式共享)                              │
│    - 差异导航 (仅差异模式: ← 上一个 / 下一个 →)              │
│    - 复制、创建规则、全屏 (共享)                             │
│                                                              │
│  内容区:                                                     │
│    - 左: FileTree (共享)                                    │
│    - 右: FileContentPanel (内容模式) / DiffContentPanel (差异模式) │
└─────────────────────────────────────────────────────────────┘
```

## Migration Plan

### 实施步骤

1. 直接重命名 `FileBrowserView.tsx` 为 `UnifiedContentView.tsx`
2. 添加 `isDiffMode` state 和相关逻辑
3. 修改工具栏，添加差异对比按钮和导航按钮
4. 修改 `RequestDetailPanel.tsx`，移除视图切换标签
5. 删除废弃组件：`SummaryView.tsx`, `DiffView.tsx`, `DiffToolbar.tsx`
6. 更新相关导入和引用

## Risks / Trade-offs

### 风险

| 风险 | 影响 | 缓解措施 |
|------|------|----------|
| 状态管理复杂度增加 | 中 | 使用清晰的 state 命名和注释 |
| 工具栏逻辑复杂 | 低 | 抽取按钮渲染逻辑为独立函数 |
| 用户习惯改变 | 低 | 差异对比按钮显眼，易于发现 |

### 权衡

- **简化 vs 灵活性**：牺牲了"结构概览"视图，换取更简洁的界面
  - 缓解：如果用户需要，可以将结构概览作为内容详情的默认折叠状态

## Open Questions

1. ~~是否需要保留"结构概览"功能？~~
   - **决策**：不保留。当前方案中，用户可通过文件树导航达到类似效果

2. 差异对比模式下，"纯文本/预览"切换是否有效？
   - **待确认**：需要与用户确认差异模式下是否需要预览功能
