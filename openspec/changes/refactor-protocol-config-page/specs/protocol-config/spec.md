## ADDED Requirements

### Requirement: 工具选择

系统 SHALL 提供工具选择器，允许用户选择要配置的客户端工具（如 claude_code、codex、gemini）。

#### Scenario: 选择工具

- **WHEN** 用户打开协议配置页面
- **THEN** 系统显示可用的工具列表（claude_code、codex、gemini）
- **AND** 用户可以点击选择其中一个工具
- **AND** 选中的工具高亮显示

#### Scenario: 工具选择影响供应商列表

- **WHEN** 用户选择了一个工具（如 claude_code）
- **THEN** 系统根据工具类型过滤显示相关的供应商
- **AND** 供应商列表按协议类型分组显示

### Requirement: 供应商列表展示

系统 SHALL 按协议类型分组显示供应商列表，每个供应商显示名称、上游地址和启用状态。

#### Scenario: 查看供应商列表

- **WHEN** 用户选择了工具
- **THEN** 系统显示该工具可用的供应商列表
- **AND** 供应商按协议类型分组（Claude、OpenAI/Codex、Gemini）
- **AND** 每个供应商显示名称、上游地址和启用状态

#### Scenario: 启用供应商

- **WHEN** 用户点击供应商的启用按钮（●）
- **THEN** 系统启用该供应商
- **AND** 禁用同一协议组内的其他供应商
- **AND** 更新转换链预览

#### Scenario: 禁用供应商

- **WHEN** 用户点击供应商的禁用按钮（○）
- **THEN** 系统禁用该供应商
- **AND** 清除转换链预览

### Requirement: 供应商管理

系统 SHALL 允许用户添加、编辑和删除供应商。

#### Scenario: 添加供应商

- **WHEN** 用户点击"添加供应商"按钮
- **THEN** 系统弹出添加供应商表单
- **AND** 用户可以填写名称、协议类型、上游地址、API Key 和认证类型
- **AND** 系统验证表单数据
- **AND** 保存成功后更新供应商列表

#### Scenario: 编辑供应商

- **WHEN** 用户点击供应商的"编辑"按钮
- **THEN** 系统弹出编辑供应商表单
- **AND** 表单预填充供应商的当前配置
- **AND** 用户可以修改配置
- **AND** 保存成功后更新供应商列表

#### Scenario: 删除供应商

- **WHEN** 用户点击供应商的"删除"按钮
- **THEN** 系统显示确认提示
- **AND** 用户确认后删除供应商
- **AND** 更新供应商列表

### Requirement: 转换链可视化

系统 SHALL 实时显示当前配置的转换链，包括工具、转换器和供应商。

#### Scenario: 显示转换链

- **WHEN** 用户选择了工具和启用了供应商
- **THEN** 系统显示转换链预览
- **AND** 转换链格式为：工具 ──[转换器]──> 供应商
- **AND** 如果无需转换，显示：工具 ──[无需转换]──> 供应商

#### Scenario: 查看转换详情

- **WHEN** 用户点击"查看转换详情"按钮
- **THEN** 系统弹出转换详情弹窗
- **AND** 显示每个转换步骤的输入、输出、耗时和状态
- **AND** 显示总耗时和总状态

### Requirement: 测试验证

系统 SHALL 提供测试验证功能，允许用户使用示例请求测试当前配置。

#### Scenario: 运行测试

- **WHEN** 用户点击"运行测试"按钮
- **THEN** 系统发送测试请求到转换预览 API
- **AND** 显示测试结果（成功/失败、耗时）
- **AND** 如果失败，显示错误信息

#### Scenario: 加载示例请求

- **WHEN** 用户点击"加载示例"按钮
- **THEN** 系统填充标准的示例请求到编辑器
- **AND** 用户可以修改示例请求

#### Scenario: 验证 JSON 格式

- **WHEN** 用户编辑请求体
- **THEN** 系统实时验证 JSON 格式
- **AND** 如果格式无效，显示错误提示
- **AND** 阻止运行测试

### Requirement: 配置保存

系统 SHALL 允许用户保存当前配置。

#### Scenario: 保存配置

- **WHEN** 用户点击"保存"按钮
- **THEN** 系统验证配置
- **AND** 保存配置到后端
- **AND** 显示保存成功提示

#### Scenario: 重置配置

- **WHEN** 用户点击"重置"按钮
- **THEN** 系统恢复到上次保存的配置
- **AND** 显示重置成功提示

### Requirement: 响应式布局

系统 SHALL 支持不同屏幕尺寸的响应式布局。

#### Scenario: 桌面端布局

- **WHEN** 用户在桌面端（≥1024px）访问
- **THEN** 系统使用单列布局，最大宽度 1200px
- **AND** 各 Section 垂直排列

#### Scenario: 平板端布局

- **WHEN** 用户在平板端（768px - 1023px）访问
- **THEN** 系统使用单列布局
- **AND** 供应商卡片网格布局（2列）

#### Scenario: 移动端布局

- **WHEN** 用户在移动端（<768px）访问
- **THEN** 系统使用单列布局
- **AND** 供应商卡片单列显示

### Requirement: 错误处理

系统 SHALL 提供友好的错误提示和处理机制。

#### Scenario: API 请求失败

- **WHEN** API 请求失败
- **THEN** 系统显示友好的错误提示
- **AND** 错误信息包含原因和建议解决方案

#### Scenario: 网络错误

- **WHEN** 网络连接失败
- **THEN** 系统显示网络错误提示
- **AND** 提供重试按钮

#### Scenario: 表单验证失败

- **WHEN** 表单验证失败
- **THEN** 系统高亮显示错误字段
- **AND** 显示具体的错误信息