## 1. 准备工作

- [ ] 1.1 创建新的页面目录结构 `frontend/src/pages/ProtocolConfigPage.tsx`
- [ ] 1.2 创建组件目录 `frontend/src/components/protocol-config/`

## 2. 实现核心组件

- [ ] 2.1 实现工具选择器组件 (`ToolSelector.tsx`)
  - [ ] 2.1.1 定义工具数据结构（claude_code, codex, gemini）
  - [ ] 2.1.2 实现卡片式选择界面
  - [ ] 2.1.3 添加选中状态和交互逻辑

- [ ] 2.2 实现供应商列表组件 (`SupplierList.tsx`)
  - [ ] 2.2.1 实现协议分组逻辑
  - [ ] 2.2.2 实现供应商卡片展示
  - [ ] 2.2.3 实现启用/禁用切换功能
  - [ ] 2.2.4 实现编辑/删除操作

- [ ] 2.3 实现转换链可视化组件 (`TransformationChainView.tsx`)
  - [ ] 2.3.1 实现简化版转换链展示
  - [ ] 2.3.2 实现转换详情弹窗
  - [ ] 2.3.3 集成转换预览 API

- [ ] 2.4 实现测试验证组件 (`TestValidation.tsx`)
  - [ ] 2.4.1 实现请求示例编辑器
  - [ ] 2.4.2 实现运行测试功能
  - [ ] 2.4.3 实现测试结果展示

- [ ] 2.5 实现供应商弹窗组件 (`SupplierModal.tsx`)
  - [ ] 2.5.1 实现添加供应商表单
  - [ ] 2.5.2 实现编辑供应商表单
  - [ ] 2.5.3 实现表单验证

## 3. 集成主页面

- [ ] 3.1 实现 `ProtocolConfigPage.tsx`
  - [ ] 3.1.1 整合所有子组件
  - [ ] 3.1.2 实现状态管理
  - [ ] 3.1.3 实现页面布局

- [ ] 3.2 更新路由配置
  - [ ] 3.2.1 在 `App.tsx` 中移除旧路由
  - [ ] 3.2.2 添加新的 `protocol-config` 路由
  - [ ] 3.2.3 更新导航菜单

## 4. API 集成

- [ ] 4.1 集成供应商管理 API
  - [ ] 4.1.1 复用现有的 `useSuppliers` hook
  - [ ] 4.1.2 复用现有的 `useCreateSupplier` hook
  - [ ] 4.1.3 复用现有的 `useUpdateSupplier` hook
  - [ ] 4.1.4 复用现有的 `useDeleteSupplier` hook
  - [ ] 4.1.5 复用现有的 `useToggleSupplier` hook

- [ ] 4.2 集成协议转换 API
  - [ ] 4.2.1 复用现有的 `/_promptxy/transform/preview` API
  - [ ] 4.2.2 实现测试验证逻辑

## 5. 样式和交互优化

- [ ] 5.1 应用统一的样式规范
  - [ ] 5.1.1 遵循现有的 color system
  - [ ] 5.1.2 使用 HeroUI 组件库
  - [ ] 5.1.3 保持与现有页面风格一致

- [ ] 5.2 实现响应式布局
  - [ ] 5.2.1 桌面端布局（≥1024px）
  - [ ] 5.2.2 平板端布局（768px - 1023px）
  - [ ] 5.2.3 移动端布局（<768px）

- [ ] 5.3 添加交互反馈
  - [ ] 5.3.1 加载状态提示
  - [ ] 5.3.2 成功/失败提示
  - [ ] 5.3.3 错误信息展示

## 6. 测试

- [ ] 6.1 单元测试
  - [ ] 6.1.1 测试工具选择器组件
  - [ ] 6.1.2 测试供应商列表组件
  - [ ] 6.1.3 测试转换链可视化组件
  - [ ] 6.1.4 测试测试验证组件

- [ ] 6.2 集成测试
  - [ ] 6.2.1 测试完整的配置流程
  - [ ] 6.2.2 测试供应商切换功能
  - [ ] 6.2.3 测试转换预览功能
  - [ ] 6.2.4 测试测试验证功能

- [ ] 6.3 手动测试
  - [ ] 6.3.1 测试工具选择
  - [ ] 6.3.2 测试供应商添加/编辑/删除
  - [ ] 6.3.3 测试转换链展示
  - [ ] 6.3.4 测试测试验证

## 9. 增强监控页面

- [ ] 9.1 扩展后端数据存储
  - [ ] 9.1.1 在 `types.ts` 中扩展 `RequestRecord` 类型，新增字段：
    - `supplierId?: string`
    - `supplierName?: string`
    - `transformerChain?: string[]`
    - `transformTrace?: TransformTrace`
  - [ ] 9.1.2 在 `gateway.ts` 中记录供应商和转换信息
  - [ ] 9.1.3 确保向后兼容（新字段为可选）
  - [ ] 9.1.4 更新数据库 schema（如果使用数据库）

- [ ] 9.2 增强请求详情显示
  - [ ] 9.2.1 实现请求详情组件 (`RequestDetailCard.tsx`)
    - [ ] 9.2.1.1 显示供应商信息（名称、地址）
    - [ ] 9.2.1.2 显示转换链可视化
    - [ ] 9.2.1.3 显示转换追踪摘要
    - [ ] 9.2.1.4 实现"查看转换详情"弹窗
    - [ ] 9.2.1.5 实现"跳转到配置"功能
  - [ ] 9.2.2 在 `RequestsPage.tsx` 中集成请求详情组件
  - [ ] 9.2.3 实现转换详情弹窗组件 (`TransformDetailModal.tsx`)
  - [ ] 9.2.4 优化样式和布局

## 10. 全局配置状态指示器

- [ ] 10.1 实现配置状态 hooks
  - [ ] 10.1.1 创建 `useConfigStatus` hook
  - [ ] 10.1.2 获取每个路径对应的供应商
  - [ ] 10.1.3 实现实时更新逻辑

- [ ] 10.2 在 Header 中显示配置状态
  - [ ] 10.2.1 实现 `ConfigStatusIndicator` 组件
  - [ ] 10.2.2 显示每个路径的供应商名称
  - [ ] 10.2.3 实现点击跳转功能
  - [ ] 10.2.4 优化布局和样式
  - [ ] 10.2.5 集成到 Header 组件

## 11. 文档和清理

- [ ] 11.1 更新组件文档
  - [ ] 11.1.1 添加组件注释
  - [ ] 11.1.2 添加使用示例

- [ ] 11.2 清理旧代码
  - [ ] 11.2.1 删除 `ProtocolLabPage.tsx`
  - [ ] 11.2.2 删除 `SupplierManagement.tsx`
  - [ ] 11.2.3 清理未使用的导入

- [ ] 11.3 更新项目文档
  - [ ] 11.3.1 更新 README（如果需要）
  - [ ] 11.3.2 更新用户指南（如果需要）

## 12. 代码审查和优化

- [ ] 12.1 代码审查
  - [ ] 12.1.1 检查代码质量
  - [ ] 12.1.2 检查类型安全
  - [ ] 12.1.3 检查性能问题

- [ ] 12.2 优化
  - [ ] 12.2.1 优化组件渲染性能
  - [ ] 12.2.2 优化状态管理
  - [ ] 12.2.3 优化错误处理

## 9. 增强监控页面

- [ ] 9.1 修改后端数据存储
  - [ ] 9.1.1 在 `RequestRecord` 类型中新增字段：
    - `supplierId?: string`
    - `supplierName?: string`
    - `transformerChain?: string[]`
    - `transformTrace?: TransformTrace`
  - [ ] 9.1.2 在 `gateway.ts` 中记录供应商和转换信息
  - [ ] 9.1.3 确保向后兼容（新字段可选）

- [ ] 9.2 增强 RequestsPage 详情显示
  - [ ] 9.2.1 在请求详情卡片中新增"路由信息"区域
  - [ ] 9.2.2 显示供应商名称和地址
  - [ ] 9.2.3 显示转换链可视化
  - [ ] 9.2.4 显示转换追踪信息（弹窗）
  - [ ] 9.2.5 添加跳转到配置页面的链接

## 10. 全局配置状态指示器

- [ ] 10.1 实现 Header 配置状态指示器
  - [ ] 10.1.1 在 Header 中添加"配置状态"区域
  - [ ] 10.1.2 显示每个路径（/claude, /openai, /gemini）对应的供应商
  - [ ] 10.1.3 实时更新（配置变更后自动刷新）
  - [ ] 10.1.4 点击跳转到配置页面

- [ ] 10.2 集成到 Header 组件
  - [ ] 10.2.1 修改 `Header.tsx`
  - [ ] 10.2.2 使用 `useSuppliers` hook 获取配置
  - [ ] 10.2.3 实现配置状态显示逻辑