# PromptXY

> æœ¬åœ°HTTPä»£ç†è§„åˆ™ç®¡ç†å™¨

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

### ğŸ¯ è¯·æ±‚æ‹¦æˆªä¸ä¿®æ”¹

- **å®æ—¶æ•è·**: è®°å½•æ‰€æœ‰ç»è¿‡ä»£ç†çš„è¯·æ±‚
- **è§„åˆ™å¼•æ“**: 7ç§æ“ä½œç±»å‹ï¼Œæ”¯æŒæ­£åˆ™è¡¨è¾¾å¼
- **å¤šå®¢æˆ·ç«¯æ”¯æŒ**: Claude Code, Codex CLI, Gemini CLI
- **å·®å¼‚å¯¹æ¯”**: å¯è§†åŒ–åŸå§‹ vs ä¿®æ”¹åè¯·æ±‚

### ğŸ“Š è¯·æ±‚å†å²

- **SQLiteå­˜å‚¨**: é«˜æ•ˆçš„æœ¬åœ°æ•°æ®åº“
- **è‡ªåŠ¨æ¸…ç†**: ä¿ç•™æœ€è¿‘100æ¡è¯·æ±‚ï¼ˆå¯é…ç½®ï¼‰
- **å®æ—¶æ¨é€**: SSEå®æ—¶æ›´æ–°UI
- **æœç´¢ç­›é€‰**: æŒ‰å®¢æˆ·ç«¯ã€æ—¶é—´ã€å†…å®¹ç­›é€‰

### ğŸ¨ Web UI

- **è§„åˆ™ç®¡ç†**: å¯è§†åŒ–CRUDæ“ä½œ
- **è¯·æ±‚ç›‘æ§**: å®æ—¶æŸ¥çœ‹è¯·æ±‚æµ
- **é¢„è§ˆæµ‹è¯•**: æ²™ç›’ç¯å¢ƒæµ‹è¯•è§„åˆ™
- **é…ç½®ç®¡ç†**: å¯¼å…¥/å¯¼å‡ºé…ç½®

## ğŸ—ï¸ æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ç”¨æˆ·æ“ä½œ                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å‰ç«¯ (React + HeroUI)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  è§„åˆ™ç®¡ç†    â”‚  â”‚  è¯·æ±‚æŸ¥çœ‹    â”‚  â”‚  é¢„è§ˆæµ‹è¯•    â”‚     â”‚
â”‚  â”‚  (UIå±‚)      â”‚  â”‚  (UIå±‚)      â”‚  â”‚  (UIå±‚)      â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚         â”‚                 â”‚                 â”‚              â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                  â”‚                 â”‚                       â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚         â”‚  APIå®¢æˆ·ç«¯      â”‚  â”‚  SSEå®¢æˆ·ç«¯ â”‚               â”‚
â”‚         â”‚  (fetch/axios)  â”‚  â”‚  (EventSource)â”‚             â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜               â”‚

                   â”‚                  â”‚
                   â†“                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åç«¯ (Node.js + TS)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚            ç»Ÿä¸€æœåŠ¡å™¨ (Gateway + API)                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â”‚  APIè·¯ç”±     â”‚  â”‚  SSEæ¨é€     â”‚  â”‚  ä»£ç†æ ¸å¿ƒ    â”‚  â”‚
â”‚  â”‚  â”‚  /_promptxy/*â”‚  â”‚  /_promptxy  â”‚  â”‚  /claude/*   â”‚  â”‚
â”‚  â”‚  â”‚              â”‚  â”‚              â”‚  â”‚  /openai/*   â”‚  â”‚
â”‚  â”‚  â”‚              â”‚  â”‚              â”‚  â”‚  /gemini/*   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚            â”‚                  â”‚                  â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                     â”‚                  â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚            â”‚  SQLiteæ•°æ®åº“   â”‚  â”‚  é…ç½®æ–‡ä»¶  â”‚               â”‚
â”‚            â”‚  (è¯·æ±‚å†å²)     â”‚  â”‚  (è§„åˆ™)    â”‚               â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CLIå·¥å…· (Claude/Codex/Gemini)             â”‚
â”‚  å‘èµ·è¯·æ±‚ â†’ ç»è¿‡ä»£ç† â†’ è§„åˆ™ä¿®æ”¹ â†’ è½¬å‘ä¸Šæ¸¸API                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Node.js 18+
- npm æˆ– pnpm

### å¼€å‘ç¯å¢ƒ

**1. å…‹éš†å¹¶å®‰è£…ä¾èµ–**

```bash
chmod +x scripts/*.sh
```

**2. å¯åŠ¨å¼€å‘æœåŠ¡**

```bash
./scripts/dev.sh
```

è¿™å°†åŒæ—¶å¯åŠ¨ï¼š

- åç«¯ç»Ÿä¸€æœåŠ¡å™¨ (è‡ªåŠ¨åˆ†é…ç«¯å£ï¼Œ8000-9000èŒƒå›´)
- å‰ç«¯å¼€å‘æœåŠ¡å™¨ (ç«¯å£ 5173)

**3. è®¿é—® Web UI**

```
http://localhost:5173
```

### ç”Ÿäº§éƒ¨ç½²

**1. æ„å»ºé¡¹ç›®**

```bash
./scripts/build.sh
```

**2. å¯åŠ¨æœåŠ¡**

```bash
cd backend
npm start -- --port 8888
```

è®¿é—®: `http://127.0.0.1:8888/_promptxy/`

## ğŸ”§ CLI é…ç½®

### Claude Code

```bash
export ANTHROPIC_BASE_URL="http://127.0.0.1:PORT/claude"
```

### Codex CLI

```bash
export OPENAI_BASE_URL="http://127.0.0.1:PORT/openai"
```

### Gemini CLI

```bash
export GOOGLE_GEMINI_BASE_URL="http://127.0.0.1:PORT/gemini"
```

> å°† `PORT` æ›¿æ¢ä¸ºå®é™…è¿è¡Œç«¯å£ã€‚æ‰€æœ‰ CLI é…ç½®éƒ½å¿…é¡»å¸¦ä¸Šè·¯å¾„å‰ç¼€ï¼ˆ`/claude`ã€`/openai`ã€`/gemini`ï¼‰ã€‚

## ğŸ“ é…ç½®æ–‡ä»¶

é…ç½®æ–‡ä»¶ä½ç½®: `~/.promptxy/config.json` æˆ–é¡¹ç›®æ ¹ç›®å½• `promptxy.config.json`

```json
{
  "listen": {
    "host": "127.0.0.1",
    "port": 7070
  },
  "suppliers": [
    {
      "id": "claude-anthropic",
      "name": "Claude (Anthropic)",
      "baseUrl": "https://api.anthropic.com",
      "localPrefix": "/claude",
      "pathMappings": [],
      "enabled": true
    },
    {
      "id": "openai-official",
      "name": "OpenAI Official",
      "baseUrl": "https://api.openai.com",
      "localPrefix": "/openai",
      "pathMappings": [],
      "enabled": true
    },
    {
      "id": "gemini-google",
      "name": "Gemini (Google)",
      "baseUrl": "https://generativelanguage.googleapis.com",
      "localPrefix": "/gemini",
      "pathMappings": [],
      "enabled": true
    }
  ],
  "rules": [
    {
      "uuid": "rule-001",
      "name": "æ·»åŠ è‡ªå®šä¹‰ç³»ç»Ÿæç¤º",
      "when": {
        "client": "claude",
        "field": "system"
      },
      "ops": [
        {
          "type": "append",
          "text": "\n\n## Custom Rules\n- Be concise\n- Use markdown"
        }
      ]
    }
  ],
  "storage": {
    "maxHistory": 100
  },
  "debug": false
}
```

## ğŸ¨ è§„åˆ™ç±»å‹

### æ”¯æŒçš„æ“ä½œç±»å‹

| ç±»å‹            | æè¿°         | å‚æ•°                           |
| --------------- | ------------ | ------------------------------ |
| `set`           | å®Œå…¨æ›¿æ¢     | `text`                         |
| `append`        | è¿½åŠ åˆ°æœ«å°¾   | `text`                         |
| `prepend`       | æ’å…¥åˆ°å¼€å¤´   | `text`                         |
| `replace`       | æ›¿æ¢åŒ¹é…å†…å®¹ | `match`/`regex`, `replacement` |
| `delete`        | åˆ é™¤åŒ¹é…å†…å®¹ | `match`/`regex`                |
| `insert_before` | åœ¨åŒ¹é…å‰æ’å…¥ | `regex`, `text`                |
| `insert_after`  | åœ¨åŒ¹é…åæ’å…¥ | `regex`, `text`                |

### åŒ¹é…æ¡ä»¶

- `client`: `claude` | `codex` | `gemini`
- `field`: `system` | `instructions`
- `method`: HTTPæ–¹æ³• (å¯é€‰)
- `pathRegex`: è·¯å¾„æ­£åˆ™ (å¯é€‰)
- `modelRegex`: æ¨¡å‹æ­£åˆ™ (å¯é€‰)

## ğŸ“š API ç«¯ç‚¹

æ‰€æœ‰APIç«¯ç‚¹éƒ½åœ¨ç»Ÿä¸€æœåŠ¡å™¨ä¸Šï¼Œä½¿ç”¨ `/_promptxy/` å‰ç¼€ï¼š

- `GET /_promptxy/health` - å¥åº·æ£€æŸ¥
- `GET /_promptxy/events` - SSEå®æ—¶æ¨é€
- `GET /_promptxy/requests` - è¯·æ±‚å†å²åˆ—è¡¨
- `GET /_promptxy/requests/:id` - è¯·æ±‚è¯¦æƒ…
- `DELETE /_promptxy/requests/:id` - åˆ é™¤è¯·æ±‚
- `GET /_promptxy/config` - è·å–é…ç½®
- `POST /_promptxy/config/sync` - åŒæ­¥é…ç½®
- `POST /_promptxy/rules` - åˆ›å»ºè§„åˆ™
- `PUT /_promptxy/rules/:id` - æ›´æ–°è§„åˆ™
- `DELETE /_promptxy/rules/:id` - åˆ é™¤è§„åˆ™
- `GET /_promptxy/suppliers` - è·å–ä¾›åº”å•†åˆ—è¡¨
- `POST /_promptxy/suppliers` - åˆ›å»ºä¾›åº”å•†
- `PUT /_promptxy/suppliers/:id` - æ›´æ–°ä¾›åº”å•†
- `DELETE /_promptxy/suppliers/:id` - åˆ é™¤ä¾›åº”å•†
- `POST /_promptxy/suppliers/:id/toggle` - åˆ‡æ¢ä¾›åº”å•†çŠ¶æ€
- `POST /_promptxy/preview` - é¢„è§ˆè§„åˆ™
- `POST /_promptxy/requests/cleanup` - æ¸…ç†æ•°æ®
- `GET /_promptxy/settings` - è·å–è®¾ç½®
- `POST /_promptxy/settings` - æ›´æ–°è®¾ç½®
- `GET /_promptxy/stats` - ç»Ÿè®¡ä¿¡æ¯
- `GET /_promptxy/database` - æ•°æ®åº“ä¿¡æ¯

## ğŸ› ï¸ å¼€å‘

### é¡¹ç›®ç»“æ„

```
promptxy/
â”œâ”€â”€ backend/                    # åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main.ts            # åº”ç”¨å…¥å£
â”‚   â”‚   â”œâ”€â”€ promptxy/
â”‚   â”‚   â”‚   â”œâ”€â”€ gateway.ts     # ç»Ÿä¸€æœåŠ¡å™¨(Gateway + API)
â”‚   â”‚   â”‚   â”œâ”€â”€ api-handlers.ts # APIå¤„ç†å‡½æ•°
â”‚   â”‚   â”‚   â”œâ”€â”€ cli.ts         # å‘½ä»¤è¡Œå‚æ•°è§£æ
â”‚   â”‚   â”‚   â”œâ”€â”€ port-utils.ts  # ç«¯å£è®¡ç®—å·¥å…·
â”‚   â”‚   â”‚   â”œâ”€â”€ database.ts    # SQLiteæ“ä½œ
â”‚   â”‚   â”‚   â”œâ”€â”€ config.ts      # é…ç½®ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ types.ts       # ç±»å‹å®šä¹‰
â”‚   â”‚   â”‚   â”œâ”€â”€ rules/         # è§„åˆ™å¼•æ“
â”‚   â”‚   â”‚   â””â”€â”€ adapters/      # é€‚é…å™¨
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ tsconfig.json
â”‚
â”œâ”€â”€ frontend/                   # å‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main.tsx           # åº”ç”¨å…¥å£
â”‚   â”‚   â”œâ”€â”€ App.tsx            # ä¸»ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ components/        # UIç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ pages/             # é¡µé¢
â”‚   â”‚   â”œâ”€â”€ hooks/             # React Hooks
â”‚   â”‚   â”œâ”€â”€ api/               # APIå®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ store/             # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ types/             # ç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ utils/             # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ styles/            # æ ·å¼
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ vite.config.ts
â”‚   â””â”€â”€ tsconfig.json
â”‚
â”œâ”€â”€ scripts/                    # è„šæœ¬
â”‚   â”œâ”€â”€ dev.sh                 # å¼€å‘ç¯å¢ƒ
â”‚   â””â”€â”€ build.sh               # æ„å»º
â”‚
â”œâ”€â”€ docs/                       # æ–‡æ¡£
â””â”€â”€ README.md
```

### æŠ€æœ¯æ ˆ

**åç«¯**

- Node.js + TypeScript
- SQLite (æ•°æ®åº“)
- HTTP Server (åŸç”Ÿ)

**å‰ç«¯**

- React 18
- HeroUI (ç»„ä»¶åº“)
- Zustand (çŠ¶æ€ç®¡ç†)
- TanStack Query (æ•°æ®è·å–)
- Vite (æ„å»ºå·¥å…·)
- Tailwind CSS

## ğŸ”’ å®‰å…¨æ€§

- **æœ¬åœ°è¿è¡Œ**: é»˜è®¤ç»‘å®š 127.0.0.1
- **æ•æ„Ÿä¿¡æ¯**: ä¸å­˜å‚¨APIå¯†é’¥
- **æ•°æ®æ¸…ç†**: è‡ªåŠ¨æ¸…ç†æ—§è¯·æ±‚
- **CORS**: å¼€å‘ç¯å¢ƒå¯ç”¨ï¼Œç”Ÿäº§ç¯å¢ƒç¦ç”¨

## ğŸ“Š æ€§èƒ½

- **æ•°æ®åº“**: SQLiteå¤„ç†1000+è¯·æ±‚æ— å‹åŠ›
- **å‰ç«¯**: è™šæ‹Ÿæ»šåŠ¨æ”¯æŒé•¿åˆ—è¡¨
- **å®æ—¶**: SSEè½»é‡çº§æ¨é€
- **å†…å­˜**: è‡ªåŠ¨æ¸…ç†é™åˆ¶åœ¨100æ¡è®°å½•

## ğŸ¤ å…¼å®¹æ€§

- **å‘åå…¼å®¹**: æ”¯æŒæ—§ç‰ˆé…ç½®è‡ªåŠ¨è¿ç§»
- **æ— ç ´åæ€§**: ç°æœ‰é…ç½®å¹³æ»‘å‡çº§
- **æ¸è¿›å¼**: å¯é€‰åŠŸèƒ½ï¼Œä¸å½±å“CLIä½¿ç”¨

## ğŸ“„ è®¸å¯

MIT License

---

**PromptXY** - è®©è§„åˆ™ç®¡ç†å˜å¾—ç®€å•è€Œå¼ºå¤§
