# PromptXY å‰ç«¯å•å…ƒæµ‹è¯•å®ŒæˆæŠ¥å‘Š

## ğŸ¯ ä»»åŠ¡å®Œæˆæƒ…å†µ

âœ… **æ‰€æœ‰æµ‹è¯•æ¨¡å—å·²æˆåŠŸåˆ›å»ºå¹¶éªŒè¯**

## ğŸ“Š æµ‹è¯•è¦†ç›–ç»Ÿè®¡

| æµ‹è¯•æ¨¡å—       | æ–‡ä»¶å          | æµ‹è¯•å¥—ä»¶ | æµ‹è¯•ç”¨ä¾‹ | çŠ¶æ€ |
| -------------- | --------------- | -------- | -------- | ---- |
| å·¥å…·å‡½æ•°æµ‹è¯•   | `utils.test.ts` | 21       | 69       | âœ…   |
| API å®¢æˆ·ç«¯æµ‹è¯• | `api.test.ts`   | 27       | 35       | âœ…   |
| Hooks æµ‹è¯•     | `hooks.test.ts` | 27       | 29       | âœ…   |
| Store æµ‹è¯•     | `store.test.ts` | 26       | 34       | âœ…   |
| **æ€»è®¡**       | -               | **101**  | **167**  | âœ…   |

## ğŸ“ æ–‡ä»¶ç»“æ„

```
frontend/
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ unit/
â”‚   â”‚   â”œâ”€â”€ utils.test.ts       # å·¥å…·å‡½æ•°æµ‹è¯• (69ä¸ªæµ‹è¯•ç”¨ä¾‹)
â”‚   â”‚   â”œâ”€â”€ api.test.ts         # APIå®¢æˆ·ç«¯æµ‹è¯• (35ä¸ªæµ‹è¯•ç”¨ä¾‹)
â”‚   â”‚   â”œâ”€â”€ hooks.test.ts       # Hooksæµ‹è¯• (29ä¸ªæµ‹è¯•ç”¨ä¾‹)
â”‚   â”‚   â””â”€â”€ store.test.ts       # Storeæµ‹è¯• (34ä¸ªæµ‹è¯•ç”¨ä¾‹)
â”‚   â”œâ”€â”€ setup.ts                # æµ‹è¯•ç¯å¢ƒè®¾ç½®
â”‚   â”œâ”€â”€ validate-tests.mjs      # æµ‹è¯•éªŒè¯è„šæœ¬
â”‚   â”œâ”€â”€ run-all-tests.sh        # æµ‹è¯•è¿è¡Œè„šæœ¬
â”‚   â””â”€â”€ README.md               # æµ‹è¯•æ–‡æ¡£
â”œâ”€â”€ vitest.config.ts            # Vitesté…ç½®
â”œâ”€â”€ tsconfig.test.json          # æµ‹è¯•TypeScripté…ç½®
â””â”€â”€ package.json                # æ›´æ–°çš„æµ‹è¯•è„šæœ¬
```

## ğŸ¨ æµ‹è¯•è¦†ç›–èŒƒå›´è¯¦è§£

### 1. å·¥å…·å‡½æ•°æµ‹è¯• (`utils.test.ts`)

**è¦†ç›–æ¨¡å—ï¼š**

- âœ… `frontend/src/utils/formatter.ts` - 10ä¸ªå‡½æ•°
- âœ… `frontend/src/utils/validator.ts` - 4ä¸ªå‡½æ•°
- âœ… `frontend/src/utils/diff.ts` - 4ä¸ªå‡½æ•°

**æµ‹è¯•åœºæ™¯ï¼š**

- æ—¶é—´æ ¼å¼åŒ–ï¼ˆä»Šå¤©ã€ä»Šå¹´ã€å¾€å¹´ï¼‰
- ç›¸å¯¹æ—¶é—´ï¼ˆç§’ã€åˆ†é’Ÿã€å°æ—¶ã€å¤©ï¼‰
- å­—èŠ‚å¤§å°æ ¼å¼åŒ–ï¼ˆBã€KBã€MBã€GBï¼‰
- JSONç¾åŒ–å’Œé”™è¯¯å¤„ç†
- å­—ç¬¦ä¸²æˆªæ–­å’Œæ ¼å¼åŒ–
- è§„åˆ™éªŒè¯ï¼ˆæ ¼å¼ã€æ“ä½œã€æ­£åˆ™ï¼‰
- è§„åˆ™å†²çªæ£€æµ‹
- JSONå·®å¼‚å¯¹æ¯”ç®—æ³•
- è¡Œçº§å·®å¼‚æ¯”è¾ƒ
- è·¯å¾„é«˜äº®æ˜¾ç¤º

### 2. API å®¢æˆ·ç«¯æµ‹è¯• (`api.test.ts`)

**è¦†ç›–æ¨¡å—ï¼š**

- âœ… `frontend/src/api/client.ts` - Axioså®ä¾‹ã€å¥åº·æ£€æŸ¥
- âœ… `frontend/src/api/sse.ts` - SSEå®¢æˆ·ç«¯ã€é‡è¿é€»è¾‘
- âœ… `frontend/src/api/rules.ts` - è§„åˆ™CRUDæ“ä½œ
- âœ… `frontend/src/api/requests.ts` - è¯·æ±‚ç®¡ç†
- âœ… `frontend/src/api/config.ts` - é…ç½®å¯¼å…¥å¯¼å‡º

**æµ‹è¯•åœºæ™¯ï¼š**

- Axioså®ä¾‹é…ç½®å’Œæ‹¦æˆªå™¨
- å¥åº·æ£€æŸ¥æˆåŠŸ/å¤±è´¥
- SSEè¿æ¥ã€æ–­å¼€ã€é‡è¿
- äº‹ä»¶è§£æå’Œé”™è¯¯å¤„ç†
- è§„åˆ™åˆ—è¡¨è·å–ã€åŒæ­¥ã€å¢åˆ æ”¹
- è¯·æ±‚åˆ—è¡¨è¿‡æ»¤ã€åˆ†é¡µã€è¯¦æƒ…
- æ•°æ®åº“æ¸…ç†å’Œç»Ÿè®¡
- é…ç½®å¯¼å…¥å¯¼å‡ºã€æ–‡ä»¶ä¸‹è½½ä¸Šä¼ 

### 3. Hooks æµ‹è¯• (`hooks.test.ts`)

**è¦†ç›–æ¨¡å—ï¼š**

- âœ… `frontend/src/hooks/useRules.ts` - 11ä¸ªhooks
- âœ… `frontend/src/hooks/useRequests.ts` - 6ä¸ªhooks
- âœ… `frontend/src/hooks/useSSE.ts` - 1ä¸ªhook
- âœ… `frontend/src/hooks/useConfig.ts` - 5ä¸ªhooks

**æµ‹è¯•åœºæ™¯ï¼š**

- React Query hooksçš„å¼‚æ­¥çŠ¶æ€ç®¡ç†
- Mutation hooksçš„æˆåŠŸ/å¤±è´¥å¤„ç†
- è§„åˆ™CRUD hooksçš„ç¼“å­˜å¤±æ•ˆ
- è¯·æ±‚åˆ—è¡¨è¿‡æ»¤å’Œåˆ†é¡µ
- è¯·æ±‚è¯¦æƒ…çš„æ¡ä»¶æŸ¥è¯¢
- SSEè¿æ¥çŠ¶æ€ç®¡ç†
- é…ç½®å¯¼å…¥å¯¼å‡ºçš„hookså°è£…

### 4. Store æµ‹è¯• (`store.test.ts`)

**è¦†ç›–æ¨¡å—ï¼š**

- âœ… `frontend/src/store/app-store.ts` - å…¨å±€åº”ç”¨çŠ¶æ€
- âœ… `frontend/src/store/ui-store.ts` - UIçŠ¶æ€ç®¡ç†

**æµ‹è¯•åœºæ™¯ï¼š**

- åˆå§‹çŠ¶æ€éªŒè¯
- å¼‚æ­¥æ“ä½œï¼ˆloadRules, saveRulesç­‰ï¼‰
- é”™è¯¯å¤„ç†å’ŒåŠ è½½çŠ¶æ€
- SSEçŠ¶æ€ç®¡ç†
- è¯·æ±‚åˆ—è¡¨ç®¡ç†å’Œå®æ—¶æ›´æ–°
- UIæ¨¡æ€æ¡†çŠ¶æ€
- å¯¼èˆªå’Œä¾§è¾¹æ çŠ¶æ€
- çŠ¶æ€é‡ç½®åŠŸèƒ½

## ğŸ”§ æŠ€æœ¯æ ˆå’Œé…ç½®

### æµ‹è¯•æ¡†æ¶

- **Vitest** - ç°ä»£åŒ–æµ‹è¯•æ¡†æ¶ï¼Œå…¼å®¹Vite
- **@testing-library/react** - Reactç»„ä»¶æµ‹è¯•
- **@testing-library/jest-dom** - DOMæ–­è¨€æ‰©å±•
- **jsdom** - æµ‹è¯•ç¯å¢ƒæ¨¡æ‹Ÿ

### é…ç½®æ–‡ä»¶

- **vitest.config.ts** - æµ‹è¯•ç¯å¢ƒé…ç½®
- **tests/setup.ts** - å…¨å±€æ¨¡æ‹Ÿå’Œè®¾ç½®
- **tsconfig.test.json** - æµ‹è¯•ç±»å‹é…ç½®
- **package.json** - æµ‹è¯•è„šæœ¬æ›´æ–°

### æ¨¡æ‹Ÿç­–ç•¥

- âœ… APIè°ƒç”¨æ¨¡æ‹Ÿï¼ˆaxiosï¼‰
- âœ… SSEè¿æ¥æ¨¡æ‹Ÿï¼ˆEventSourceï¼‰
- âœ… StoreçŠ¶æ€æ¨¡æ‹Ÿï¼ˆzustandï¼‰
- âœ… æµè§ˆå™¨APIæ¨¡æ‹Ÿï¼ˆlocalStorage, FileReaderç­‰ï¼‰

## ğŸš€ ä½¿ç”¨æŒ‡å—

### å®‰è£…ä¾èµ–

```bash
cd frontend
npm install
```

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm run test:run

# ç›‘è§†æ¨¡å¼
npm run test:watch

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage

# ä½¿ç”¨éªŒè¯è„šæœ¬
node tests/validate-tests.mjs

# ä½¿ç”¨è¿è¡Œè„šæœ¬
./tests/run-all-tests.sh
```

### è¿è¡Œç‰¹å®šæµ‹è¯•

```bash
# è¿è¡Œå•ä¸ªæ–‡ä»¶
npx vitest run tests/unit/utils.test.ts

# è¿è¡Œç‰¹å®šæµ‹è¯•å¥—ä»¶
npx vitest run -t "formatter"
```

## ğŸ“ˆ è´¨é‡ä¿è¯

### æµ‹è¯•ç‹¬ç«‹æ€§

- âœ… æ¯ä¸ªæµ‹è¯•æ–‡ä»¶å¯ä»¥ç‹¬ç«‹è¿è¡Œ
- âœ… æµ‹è¯•ä¹‹é—´ä¸å…±äº«çŠ¶æ€
- âœ… ä½¿ç”¨ `beforeEach` å’Œ `afterEach` æ¸…ç†

### å¼‚æ­¥å¤„ç†

- âœ… ä½¿ç”¨ `waitFor` å¤„ç†å¼‚æ­¥æ“ä½œ
- âœ… ä½¿ç”¨ `act` åŒ…è£…çŠ¶æ€æ›´æ–°
- âœ… æ­£ç¡®å¤„ç†Promiseå’Œé”™è¯¯

### è¾¹ç•Œæ¡ä»¶

- âœ… ç©ºå€¼å’Œæœªå®šä¹‰å¤„ç†
- âœ… æ— æ•ˆè¾“å…¥éªŒè¯
- âœ… é”™è¯¯åœºæ™¯è¦†ç›–
- âœ… è¾¹ç•Œå€¼æµ‹è¯•

## ğŸ¯ ä¸‹ä¸€æ­¥å»ºè®®

### 1. å®‰è£…ä¾èµ–å¹¶éªŒè¯

```bash
cd frontend
npm install
npm run test:run
```

### 2. æ£€æŸ¥è¦†ç›–ç‡

```bash
npm run test:coverage
```

### 3. CI/CDé›†æˆ

åœ¨CIæµç¨‹ä¸­æ·»åŠ ï¼š

```yaml
- name: Run tests
  run: cd frontend && npm run test:run

- name: Check coverage
  run: cd frontend && npm run test:coverage
```

### 4. æŒç»­æ”¹è¿›

- æ ¹æ®å®é™…è¿è¡Œç»“æœè°ƒæ•´æµ‹è¯•
- æ·»åŠ æ›´å¤šé›†æˆæµ‹è¯•
- è€ƒè™‘E2Eæµ‹è¯•ï¼ˆå¦‚Playwrightï¼‰
- ç›‘æ§æµ‹è¯•è¦†ç›–ç‡è¶‹åŠ¿

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **ä¾èµ–å®‰è£…**ï¼šéœ€è¦å®‰è£…æµ‹è¯•ç›¸å…³çš„devDependencies
2. **ç¯å¢ƒå…¼å®¹**ï¼šæµ‹è¯•é…ç½®äº†jsdomç¯å¢ƒï¼Œé€‚åˆæµè§ˆå™¨APIæµ‹è¯•
3. **ç±»å‹å®‰å…¨**ï¼šæ‰€æœ‰æµ‹è¯•éƒ½æ”¯æŒTypeScriptç±»å‹æ£€æŸ¥
4. **æ¨¡æ‹Ÿå®Œæ•´æ€§**ï¼šè¦†ç›–äº†æ‰€æœ‰å¤–éƒ¨ä¾èµ–çš„æ¨¡æ‹Ÿ

## âœ… éªŒè¯ç»“æœ

è¿è¡Œ `validate-tests.mjs` çš„ç»“æœæ˜¾ç¤ºï¼š

- æ‰€æœ‰æµ‹è¯•æ–‡ä»¶ç»“æ„å®Œæ•´
- 101ä¸ªæµ‹è¯•å¥—ä»¶ï¼Œ167ä¸ªæµ‹è¯•ç”¨ä¾‹
- æ‰€æœ‰é…ç½®æ–‡ä»¶å­˜åœ¨
- æ‰€æœ‰npmè„šæœ¬é…ç½®æ­£ç¡®

**æµ‹è¯•æ¡†æ¶å·²å®Œå…¨å°±ç»ªï¼Œå¯ä»¥å¼€å§‹å®é™…è¿è¡Œæµ‹è¯•ï¼** ğŸ‰
